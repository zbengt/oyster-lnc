git config --global user.email "zbengt@uw.edu"
git config --global user.name "Zach Bengtsson"
git config --global zbengt@uw.edu
git config -global zbengt@uw.edu
git config --global user.email "zbengt@uw.edu"
git config --global user.name "Zach Bengtsson"
git config --global user.email "zbengt@uw.edu"
git config --global user.emailzbengt@uw.edu
git config --global user.name Zach Bengtsson
git config --global user.email zbengt@uw.edu
git config --global user.name Zach Bengtsson
git config --global user.zbengt@uw.edu
git config --global user.Zach Bengtsson
git config user.email "zbengt@uw.edu"
git config user.name "Zach Bengtsson"
library(tximportData)
library(tximport)
browseVignettes("tximport")
setwd("~/github/oyster-lnc/output/01-lncRNA-kallisto")
setwd("~/github/oyster-lnc/output/01-lncRNA-kallisto")
folders <- list.files(pattern = "S\\d+[FM]$")
print(folders)
count_matrix <- NULL
for (folder in folders) {
# set the working directory to the current folder
setwd(paste0("/path/to/main/directory/", folder))
# read in the abundance data
data <- read.table("abundance.tsv", header = TRUE, sep = "\t")
# add the abundance data to the count matrix
count_matrix <- cbind(count_matrix, data[, "est_counts"])
}
count_matrix <- NULL
for (folder in folders) {
# set the working directory to the current folder
setwd(paste0("~/github/oyster-lnc/output/01-lncRNA-kallisto", folder))
# read in the abundance data
data <- read.table("abundance.tsv", header = TRUE, sep = "\t")
# add the abundance data to the count matrix
count_matrix <- cbind(count_matrix, data[, "est_counts"])
}
library(graphql)
install.packages("ghql")
count_matrix <- NULL
for (folder in folders) {
# set the working directory to the current folder
setwd(paste0("~/github/oyster-lnc/output/01-lncRNA-kallisto", folder))
# read in the abundance data
data <- read.table("abundance.tsv", header = TRUE, sep = "\t")
# add the abundance data to the count matrix
count_matrix <- cbind(count_matrix, data[, "est_counts"])
}
print(count_matrix)
setwd("~/github/oyster-lnc/output/01-lncRNA-kallisto")
folders <- list.files(pattern = "S\\d+[FM]$")
print(folders)
install.packages("ghql")
count_matrix <- NULL
for (folder in folders) {
# set the working directory to the current folder
setwd(paste0("~/github/oyster-lnc/output/01-lncRNA-kallisto", folder))
# read in the abundance data
data <- read.table("abundance.tsv", header = TRUE, sep = "\t")
# add the abundance data to the count matrix
count_matrix <- cbind(count_matrix, data[, "est_counts"])
}
install.packages("ghql")
getwd()
count_matrix <- NULL
for (folder in folders) {
# set the working directory to the current folder
setwd(paste0("/github/oyster-lnc/output/01-lncRNA-kallisto", folder))
# read in the abundance data
data <- read.table("abundance.tsv", header = TRUE, sep = "\t")
# add the abundance data to the count matrix
count_matrix <- cbind(count_matrix, data[, "est_counts"])
}
install.packages("ghql")
getwd()
count_matrix <- NULL
for (folder in folders) {
# set the working directory to the current folder
setwd(paste0("/home/shared/8TB_HDD_02/zbengt/github/oyster-lnc/output//01-lncRNA-kallisto", folder))
# read in the abundance data
data <- read.table("abundance.tsv", header = TRUE, sep = "\t")
# add the abundance data to the count matrix
count_matrix <- cbind(count_matrix, data[, "est_counts"])
}
install.packages("ghql")
getwd()
count_matrix <- NULL
for (folder in folders) {
# set the working directory to the current folder
setwd(paste0("/home/shared/8TB_HDD_02/zbengt/github/oyster-lnc/output/01-lncRNA-kallisto", folder))
# read in the abundance data
data <- read.table("abundance.tsv", header = TRUE, sep = "\t")
# add the abundance data to the count matrix
count_matrix <- cbind(count_matrix, data[, "est_counts"])
}
install.packages("ghql")
getwd()
count_matrix <- NULL
for (folder in folders) {
# set the working directory to the current folder
setwd(paste0("/home/shared/8TB_HDD_02/zbengt/github/oyster-lnc/output", folder))
# read in the abundance data
data <- read.table("abundance.tsv", header = TRUE, sep = "\t")
# add the abundance data to the count matrix
count_matrix <- cbind(count_matrix, data[, "est_counts"])
}
install.packages("ghql")
getwd()
count_matrix <- NULL
for (folder in folders) {
# set the working directory to the current folder
setwd("/home/shared/8TB_HDD_02/zbengt/github/oyster-lnc/output/01-lncRNA-kallisto")
setwd(paste0("/home/shared/8TB_HDD_02/zbengt/github/oyster-lnc/output/01-lncRNA-kallisto", folder))
# read in the abundance data
data <- read.table("abundance.tsv", header = TRUE, sep = "\t")
# add the abundance data to the count matrix
count_matrix <- cbind(count_matrix, data[, "est_counts"])
}
install.packages("ghql")
getwd()
count_matrix <- NULL
for (folder in folders) {
# set the working directory to the current folder
setwd("/home/shared/8TB_HDD_02/zbengt/github/oyster-lnc/output/01-lncRNA-kallisto")
setwd(paste0("/home/shared/8TB_HDD_02/zbengt/github/oyster-lnc/output/01-lncRNA-kallisto", folder))
# read in the abundance data
data <- read.table("abundance.tsv", header = TRUE, sep = "\t")
# add the abundance data to the count matrix
count_matrix <- cbind(count_matrix, data[, "est_counts"])
}
install.packages("ghql")
getwd()
setwd("~/github/oyster-lnc/output/01-lncRNA-kallisto")
getwd()
folders <- list.files(pattern = "S\\d+[FM]$")
print(folders)
count_matrix <- NULL
for (folder in folders) {
# set the working directory to the current folder
setwd(paste0("/home/shared/8TB_HDD_02/zbengt/github/oyster-lnc/output/01-lncRNA-kallisto", folder))
# read in the abundance data
data <- read.table("abundance.tsv", header = TRUE, sep = "\t")
# add the abundance data to the count matrix
count_matrix <- cbind(count_matrix, data[, "est_counts"])
}
count_matrix <- NULL
for (folder in folders) {
# set the working directory to the current folder
setwd(paste0("/home/shared/8TB_HDD_02/zbengt/github/oyster-lnc/output/01-lncRNA-kallisto/", folder))
# read in the abundance data
data <- read.table("abundance.tsv", header = TRUE, sep = "\t")
# add the abundance data to the count matrix
count_matrix <- cbind(count_matrix, data[, "est_counts"])
}
print(count_matrix)
rownames(count_matrix) <- data[, "target_id"]
colnames(count_matrix) <- gsub(".*/", "", folders)
print(count_matrix)
setwd("/home/shared/8TB_HDD_02/zbengt/github/oyster-lnc/output/01-lncRNA-kallisto")
write.table(count_matrix, "merged_counts.txt", sep = "\t", quote = FALSE)
expression_data <- read.table("~/github/oyster-lnc/output/02-kallisto-merge", header=TRUE, sep="\t")
expression_data <- read.table("/home/shared/8TB_HDD_02/zbengt/github/oyster-lnc/output/02-kallisto-merge", header=TRUE, sep="\t")
expression_data <- read.table("~/github/oyster-lnc/output/02-kallisto-merge/merged_counts.txt", header=TRUE, sep="\t")
library(DESeq2)
expression_dds <- DESeqDataSetFromMatrix(countData = expression_data,
colData = sample_info,
design = ~ condition)
?write.table()
?write.csv()
write.csv(count_matrix, file = "merged_counts.csv", row.names = TRUE)
write.csv(count_matrix, file = "merged_counts.csv", row.names = TRUE)
setwd("/home/shared/8TB_HDD_02/zbengt/github/oyster-lnc/output/02-kallisto-merged")
setwd("/home/shared/8TB_HDD_02/zbengt/github/oyster-lnc/output/01-lncRNA-kallisto")
write.csv(count_matrix, file = "merged_counts.csv", row.names = TRUE)
setwd("/home/shared/8TB_HDD_02/zbengt/github/oyster-lnc/output/01-lncRNA-kallisto")
count_matrix <- read.csv("merged_counts.csv", row.names = 1)
View(count_matrix)
library(DESeq2)
expression_dds <- DESeqDataSetFromMatrix(countData = expression_data,
colData = sample_info,
design = ~ condition)
library(DESeq2)
expression_dds <- DESeqDataSetFromMatrix(countData = count_matrix,
colData = sample_info,
design = ~ condition)
library(DESeq2)
expression_dds <- DESeqDataSetFromMatrix(countData = count_matrix,
colData = sample_info,
design = ~ condition)
```{r}
```{r}
setwd("/home/shared/8TB_HDD_02/zbengt/github/oyster-lnc/output/01-lncRNA-kallisto")
count_matrix <- read.csv("merged_counts.csv", row.names = 1)
library(DESeq2)
expression_dds <- DESeqDataSetFromMatrix(countData = count_matrix,
colData = sample_info,
design = ~ condition)
View(count_matrix)
setwd("/home/shared/8TB_HDD_02/zbengt/github/oyster-lnc/output/01-lncRNA-kallisto")
count_matrix <- read.csv("merged_counts.csv", row.names = 1)
library(DESeq2)
expression_dds <- DESeqDataSetFromMatrix(countData = count_matrix,
colData = metadata,
design = ~ condition)
View(count_matrix)
View(count_matrix)
### data frame of conditions/treatments
metaData <- data.frame(
treatment = c("Exposed", "Control", "Control", "Control", "Exposed", "Exposed", "Exposed", "Exposed", "Exposed", "Exposed", "Control", "Exposed", "Exposed", "Control", "Exposed", "Exposed", "Control", "Control", "Control", "Exposed", "Control", "Control", "Control", "Exposed", "Control", "Exposed"),
sex = c("M", "M", "F", "F", "F", "M", "F", "M", "F", "F", "F", "F", "F", "F", "M", "F", "F", "F", "F", "M", "M", "M", "F", "F", "M", "M"),
row.names = colnames(count_matrix)
)
print(metaData)
View(metaData)
View(metaData)
library(DESeq2)
dds <- DESeqDataSetFromMatrix(countData = count_matrix,
colData = metaData,
design = ~ treatment + sex)
library(DESeq2)
dds <- DESeqDataSetFromMatrix(countData = count_matrix,
colData = metaData,
design = ~ treatment)
```{r}
```{r}
library(DESeq2)
dds <- DESeqDataSet(countData = count_matrix,
colData = metaData,
design = ~ treatment)
library(DESeq2)
dds <- DESeqDataSet(countData = count_matrix,
colData = metaData)
library(DESeq2)
dds <- DESeqDataSet(countData = count_matrix,
colData = metaDataError,
design = ~ sex + treatment)
library(DESeq2)
dds <- DESeqDataSetFromMatrix(countData = count_matrix,
colData = metaDataError,
design = ~ sex + treatment)
library(DESeq2)
dds <- DESeqDataSetFromMatrix(countData = count_matrix,
colData = metaData,
design = ~ sex + treatment)
library(DESeq2)
dds <- DESeqDataSet(countData = count_matrix,
colData = metaData,
design = ~ sex + treatment)
setwd("~/github/oyster-lnc/output/01-lncRNA-kallisto")
getwd()
folders <- list.files(pattern = "S\\d+[FM]$")
print(folders)
### data frame of conditions/treatments
metaData <- data.frame(
sample = c("S12M", "S13M", "S16F", "S19F", "S22F", "S23M", "S29F", "S31M", "S35F", "S36F", "S39F", "S3F", "S41F", "S44F", "S48M", "S50F", "S52F", "S53F", "S54F", "S59M", "S64M", "S6M", "S76F", "S77F", "S7M", "S9M")
treatment = c("Exposed", "Control", "Control", "Control", "Exposed", "Exposed", "Exposed", "Exposed", "Exposed", "Exposed", "Control", "Exposed", "Exposed", "Control", "Exposed", "Exposed", "Control", "Control", "Control", "Exposed", "Control", "Control", "Control", "Exposed", "Control", "Exposed"),
### data frame of conditions/treatments
metaData <- data.frame(
sample = c("S12M", "S13M", "S16F", "S19F", "S22F", "S23M", "S29F", "S31M", "S35F", "S36F", "S39F", "S3F", "S41F", "S44F", "S48M", "S50F", "S52F", "S53F", "S54F", "S59M", "S64M", "S6M", "S76F", "S77F", "S7M", "S9M"),
treatment = c("Exposed", "Control", "Control", "Control", "Exposed", "Exposed", "Exposed", "Exposed", "Exposed", "Exposed", "Control", "Exposed", "Exposed", "Control", "Exposed", "Exposed", "Control", "Control", "Control", "Exposed", "Control", "Control", "Control", "Exposed", "Control", "Exposed"),
sex = c("M", "M", "F", "F", "F", "M", "F", "M", "F", "F", "F", "F", "F", "F", "M", "F", "F", "F", "F", "M", "M", "M", "F", "F", "M", "M")
)
print(metaData)
View(metaData)
library(DESeq2)
dds <- DESeqDataSet(countData = count_matrix,
colData = metaData,
design = ~ sex + treatment)
library(DESeq2)
dds <- DESeqDataSetFromMatrix(countData = count_matrix,
colData = metaData,
design = ~ sex + treatment,
tidy = FALSE,
ignoreRank = FALSE)
library(DESeq2)
dds <- DESeqDataSetFromMatrix(countData = round(count_matrix),
colData = metaData,
design = ~ sex + treatment)
View(dds)
dds <- DESeq(dds)
res <- results(dds)
View(res)
library(ggplot2)
ggplot(res, aes(x=log2FoldChange, y=-log10(pvalue))) +
geom_point(aes(color=ifelse(log2FoldChange>0 & padj<0.05, "red", "black")), alpha=0.5) +
scale_color_manual(values=c("red", "black")) +
theme_classic() +
xlab("Log2 Fold Change") +
ylab("-Log10 p-value") +
ggtitle("Volcano Plot")
res <- results(dds)
View(res)
res <- results(dds)
res <- res[which(res$padj<0.05),]
library(ggplot2)
ggplot(res, aes(x=log2FoldChange, y=-log10(pvalue))) +
geom_point(aes(color=ifelse(log2FoldChange>0 & padj<0.05, "red", "black")), alpha=0.5) +
scale_color_manual(values=c("red", "black")) +
theme_classic() +
xlab("Log2 Fold Change") +
ylab("-Log10 p-value") +
ggtitle("Volcano Plot")
View(res)
res <- results(dds)
library(ggplot2)
ggplot(dds, aes(x=log2FoldChange, y=-log10(pvalue))) +
geom_point(aes(color=ifelse(log2FoldChange>0 & padj<0.05, "red", "black")), alpha=0.5) +
scale_color_manual(values=c("red", "black")) +
theme_classic() +
xlab("Log2 Fold Change") +
ylab("-Log10 p-value") +
ggtitle("Volcano Plot")
library(ggplot2)
ggplot(results, aes(x=log2FoldChange, y=-log10(pvalue))) +
geom_point(aes(color=ifelse(log2FoldChange>0 & padj<0.05, "red", "black")), alpha=0.5) +
scale_color_manual(values=c("red", "black")) +
theme_classic() +
xlab("Log2 Fold Change") +
ylab("-Log10 p-value") +
ggtitle("Volcano Plot")
library(ggplot2)
ggplot(results(dds), aes(x=log2FoldChange, y=-log10(pvalue))) +
geom_point(aes(color=ifelse(log2FoldChange>0 & padj<0.05, "red", "black")), alpha=0.5) +
scale_color_manual(values=c("red", "black")) +
theme_classic() +
xlab("Log2 Fold Change") +
ylab("-Log10 p-value") +
ggtitle("Volcano Plot")
library("ggplot2")
fc <- res$log2FoldChange
pval <- res$padj
plot_data <- data.frame(log2FoldChange = fc, neg_log10_pval = -log10(pval))
ggplot(plot_data, aes(x = log2FoldChange, y = neg_log10_pval)) +
geom_point(alpha = 0.5) +
scale_color_manual(values = c("gray", "red")) +
labs(x = "Log2 Fold Change", y = "-log10(p-value)") +
theme_bw()
setwd("/home/shared/8TB_HDD_02/zbengt/github/oyster-lnc/output/01-lncRNA-kallisto")
count_matrix <- read.csv("merged_counts.csv", row.names = 1)
### data frame of conditions/treatments
metaData <- data.frame(
sample = c("S12M", "S13M", "S16F", "S19F", "S22F", "S23M", "S29F", "S31M", "S35F", "S36F", "S39F", "S3F", "S41F", "S44F", "S48M", "S50F", "S52F", "S53F", "S54F", "S59M", "S64M", "S6M", "S76F", "S77F", "S7M", "S9M"),
treatment = c("Exposed", "Control", "Control", "Control", "Exposed", "Exposed", "Exposed", "Exposed", "Exposed", "Exposed", "Control", "Exposed", "Exposed", "Control", "Exposed", "Exposed", "Control", "Control", "Control", "Exposed", "Control", "Control", "Control", "Exposed", "Control", "Exposed"),
sex = c("M", "M", "F", "F", "F", "M", "F", "M", "F", "F", "F", "F", "F", "F", "M", "F", "F", "F", "F", "M", "M", "M", "F", "F", "M", "M")
)
print(metaData)
library(DESeq2)
dds <- DESeqDataSetFromMatrix(countData = round(count_matrix),
colData = metaData,
design = ~ sex + treatment)
dds <- DESeq(dds)
res <- results(dds)
library("ggplot2")
fc <- res$log2FoldChange
pval <- res$padj
plot_data <- data.frame(log2FoldChange = fc, neg_log10_pval = -log10(pval))
ggplot(plot_data, aes(x = log2FoldChange, y = neg_log10_pval)) +
geom_point(alpha = 0.5) +
scale_color_manual(values = c("gray", "red")) +
labs(x = "Log2 Fold Change", y = "-log10(p-value)") +
theme_bw()
